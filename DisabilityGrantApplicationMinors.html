<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Disability Assistance Grant Application</title>
    <style>
        body {
            font-family: "Helvetica Neue", Arial, sans-serif;
            line-height: 1.5;
            color: #333;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f4f4f4;
        }
        .page-nav {
            margin-bottom: 20px;
        }
        .page-nav a {
            text-decoration: none;
            color: #0056b3;
            font-weight: bold;
            font-size: 13px;
        }
        .page-nav a:hover {
            text-decoration: underline;
        }
        .container {
            background: white;
            padding: 40px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h1, h2, h3 {
            text-align: center;
            text-transform: uppercase;
        }
        h1 { font-size: 18px; margin-bottom: 5px; }
        h2 { font-size: 16px; margin-top: 0; color: #555; }
        h3 {
            background-color: #eee;
            padding: 10px;
            border-left: 5px solid #0056b3;
            margin-top: 30px;
            font-size: 14px;
        }

        /* Warning Box */
        .warning-box {
            border: 2px solid red;
            background-color: #fff0f0;
            padding: 15px;
            font-size: 12px;
            margin-top: 25px;
            margin-bottom: 20px;
            font-weight: bold;
            text-align: justify;
        }

        /* Form Layout */
        .form-row {
            display: flex;
            flex-wrap: wrap;
            margin-bottom: 15px;
            gap: 20px;
        }
        .form-group {
            flex: 1;
            min-width: 200px;
            display: flex;
            flex-direction: column;
        }
        .form-group.full-width {
            flex: 100%;
        }

        label {
            font-weight: bold;
            font-size: 12px;
            margin-bottom: 5px;
        }

        input[type="text"], input[type="date"], input[type="number"], select {
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        /* Checkbox groups */
        .checkbox-group {
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        .checkbox-options {
            display: flex;
            gap: 20px;
            margin-top: 5px;
        }

        /* Action Buttons */
        .actions {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid #333;
        }
        button {
            padding: 15px 30px;
            font-size: 16px;
            cursor: pointer;
            background-color: #0056b3;
            color: white;
            border: none;
            border-radius: 5px;
        }
        button:hover { background-color: #004494; }
        button.secondary {
            background-color: #2d8f2d;
        }
        button.secondary:hover {
            background-color: #256f25;
        }

        /* Print Styles */
        @media print {
            body { background-color: white; margin: 0; padding: 0; }
            .container { box-shadow: none; padding: 0; }
            button { display: none; }
            input, select { border: none; border-bottom: 1px solid #000; padding: 0; }
            .warning-box { border: 1px solid black; color: black; }
            h3 { border-left: none; border-bottom: 1px solid black; background: none; padding-left: 0; }
        }
    </style>
</head>
<body>

<div class="container">
    <div class="page-nav">
        <a href="index.html">&larr; Back to all government forms</a>
    </div>
    <div class="header">
        <h1>Government of the Republic of Trinidad and Tobago</h1>
        <h2>Ministry of the People, Social Development and Family Services</h2>
        <h1 style="margin-top: 20px; font-size: 22px;">Disability Assistance Grant Application (Minors)</h1>
    </div>

    <form id="dagForm">

        <h3>1. Applicant Details</h3>
        <p style="font-size: 12px; font-style: italic;">(The person applying on behalf of the child)</p>

        <div class="form-row">
            <div class="form-group">
                <label>Last Name</label>
                <input type="text" name="app_lastname">
            </div>
            <div class="form-group">
                <label>First Name</label>
                <input type="text" name="app_firstname">
            </div>
            <div class="form-group">
                <label>Middle Name</label>
                <input type="text" name="app_middlename">
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>Date of Birth</label>
                <input type="date" name="app_dob">
            </div>
            <div class="form-group">
                <label>Age</label>
                <input type="number" name="app_age" style="width: 60px;">
            </div>
            <div class="form-group">
                <label>Sex</label>
                <select name="app_sex">
                    <option value="">Select</option>
                    <option value="M">Male</option>
                    <option value="F">Female</option>
                </select>
            </div>
            <div class="form-group">
                <label>ID Card No.</label>
                <input type="text" name="app_id">
            </div>
        </div>

        <div class="form-row">
            <div class="form-group full-width">
                <label>Residential Address (Street, Town, Country)</label>
                <input type="text" name="app_res_address">
            </div>
        </div>

        <div class="form-row">
            <div class="form-group full-width">
                <label>Mailing Address (if different)</label>
                <input type="text" name="app_mail_address">
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>Relationship to Beneficiary</label>
                <select name="app_relationship">
                    <option value="Mother">Mother</option>
                    <option value="Father">Father</option>
                    <option value="Legal Guardian">Legal Guardian</option>
                </select>
            </div>
            <div class="form-group">
                <label>Marital Status</label>
                <select name="app_marital">
                    <option value="Single">Single</option>
                    <option value="Married">Married</option>
                    <option value="Widowed">Widowed</option>
                    <option value="Divorced">Divorced</option>
                    <option value="Separated">Separated</option>
                    <option value="Common Law">Common Law</option>
                </select>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>Status</label>
                <select name="app_status">
                    <option value="Citizen">Citizen</option>
                    <option value="Legal Resident">Legal Resident</option>
                </select>
            </div>
            <div class="form-group">
                <label>Resident No. (If applicable)</label>
                <input type="text" name="app_resident_no">
            </div>
            <div class="form-group">
                <label>Pin Number</label>
                <input type="text" name="app_pin">
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>Contact No. (Cell)</label>
                <input type="text" name="app_cell">
            </div>
            <div class="form-group">
                <label>Contact No. (Home)</label>
                <input type="text" name="app_home">
            </div>
        </div>

        <h3>2. Beneficiary Details (Child under 18)</h3>

        <div class="form-row">
            <div class="form-group">
                <label>Last Name</label>
                <input type="text" name="ben_lastname">
            </div>
            <div class="form-group">
                <label>First Name</label>
                <input type="text" name="ben_firstname">
            </div>
            <div class="form-group">
                <label>Middle Name</label>
                <input type="text" name="ben_middlename">
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>Date of Birth</label>
                <input type="date" name="ben_dob">
            </div>
            <div class="form-group">
                <label>Age</label>
                <input type="number" name="ben_age" style="width: 60px;">
            </div>
            <div class="form-group">
                <label>Sex</label>
                <select name="ben_sex">
                    <option value="">Select</option>
                    <option value="M">Male</option>
                    <option value="F">Female</option>
                </select>
            </div>
            <div class="form-group">
                <label>ID Card No. (If applicable)</label>
                <input type="text" name="ben_id">
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>Country of Birth</label>
                <input type="text" name="ben_cob">
            </div>
            <div class="form-group">
                <label>Status</label>
                <select name="ben_status">
                    <option value="Citizen">Citizen</option>
                    <option value="Legal Resident">Legal Resident</option>
                </select>
            </div>
            <div class="form-group">
                <label>Resident No.</label>
                <input type="text" name="ben_res_no">
            </div>
        </div>

        <h3>3. Parents' Information</h3>
        <p style="font-size: 12px; font-style: italic;">Complete if the Mother/Father are not the primary applicant listed above.</p>

        <div class="form-row">
            <div class="form-group full-width">
                <label style="text-decoration: underline;">Mother's Name (if different from Applicant)</label>
                <input type="text" name="mother_name" placeholder="Full Name">
            </div>
        </div>
        <div class="form-row">
            <div class="form-group full-width">
                <label style="text-decoration: underline;">Father's Name (if different from Applicant)</label>
                <input type="text" name="father_name" placeholder="Full Name">
            </div>
        </div>

        <h3>4. Benefit Screening Questions</h3>

        <div class="checkbox-group">
            <label>1. Are you or anyone else in receipt of Public Assistance on behalf of this child?</label>
            <div class="checkbox-options">
                <label><input type="radio" name="q1" value="Yes"> YES</label>
                <label><input type="radio" name="q1" value="No"> NO</label>
            </div>
        </div>

        <div class="checkbox-group">
            <label>2. Do you or anyone else receive any other benefits on behalf of this child?</label>
            <div class="checkbox-options">
                <label><input type="radio" name="q2" value="Yes"> YES</label>
                <label><input type="radio" name="q2" value="No"> NO</label>
            </div>
            <div class="form-row" style="margin-top: 5px;">
                <div class="form-group">
                    <label>If yes, how much?</label>
                    <input type="text" name="q2_amount">
                </div>
            </div>
        </div>

        <div class="checkbox-group">
            <label>3. Have you applied for a Disability Assistance Grant on behalf of the child before?</label>
            <div class="checkbox-options">
                <label><input type="radio" name="q3" value="Yes"> YES</label>
                <label><input type="radio" name="q3" value="No"> NO</label>
            </div>
        </div>

        <div class="checkbox-group">
            <label>4. Do you receive a Disability Assistance Grant on behalf of this child in any other district?</label>
            <div class="checkbox-options">
                <label><input type="radio" name="q4" value="Yes"> YES</label>
                <label><input type="radio" name="q4" value="No"> NO</label>
            </div>
        </div>

        <div class="checkbox-group">
            <label>5. Is the child a holder of a Trinidad and Tobago Passport?</label>
            <div class="checkbox-options">
                <label><input type="radio" name="q5" value="Yes"> YES</label>
                <label><input type="radio" name="q5" value="No"> NO</label>
            </div>
            <div class="form-row" style="margin-top: 10px;">
                <div class="form-group">
                    <label>Passport Number</label>
                    <input type="text" name="passport_number">
                </div>
                <div class="form-group">
                    <label>Date of Departure (Last 3 Years)</label>
                    <input type="date" name="date_departure">
                </div>
                <div class="form-group">
                    <label>Date of Return (Last 3 Years)</label>
                    <input type="date" name="date_return">
                </div>
            </div>
        </div>

        <div class="warning-box" role="alert">
            WARNING: Any person who, for the purpose of obtaining or continuing a Disability Assistance Grant either for himself or for any other person, knowingly makes any false statement or false representation, or who knowingly obtains payment of or continues to receive a grant in respect of which he is disqualified from receiving or which for any reason is not payable to him, is liable on summary conviction to a fine of one thousand dollars.
        </div>

        <h3>5. Declaration</h3>

        <p style="text-align: justify; font-size: 14px;">
            <input type="checkbox" name="declaration_confirmed" required>
            I declare that all the statements on this form are true to the best of my knowledge and belief and that I am not, to the best of my knowledge, disqualified from receiving a Disability Assistance Grant on behalf of a child with a disability for any of the reasons stated on this form.
        </p>

        <div class="form-row" style="margin-top: 30px;">
            <div class="form-group">
                <label>Signature of Applicant (Sign after printing)</label>
                <input type="text" disabled style="background: #eee; border-bottom: 1px solid #000;">
            </div>
            <div class="form-group">
                <label>Date</label>
                <input type="date" name="decl_date">
            </div>
        </div>

        <div class="actions">
            <button type="button" id="saveFillablePdf">Save as Fillable PDF</button>
            <button type="button" class="secondary" onclick="window.print()">Print Static Copy</button>
            <p style="font-size: 11px; color: #666; margin-top: 10px;">"Save as Fillable PDF" will export an interactive PDF with editable form fields.</p>
            <p style="font-size: 11px; color: #666; margin-top: 5px;">Use "Print Static Copy" if you need a traditional non-fillable version.</p>
        </div>

    </form>
</div>

<script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
<script>
    (function () {
        const WARNING_TEXT = 'WARNING: Any person who, for the purpose of obtaining or continuing a Disability Assistance Grant either for himself or for any other person, knowingly makes any false statement or false representation, or who knowingly obtains payment of or continues to receive a grant in respect of which he is disqualified from receiving or which for any reason is not payable to him, is liable on summary conviction to a fine of one thousand dollars.';
        const fillableBtn = document.getElementById('saveFillablePdf');
        if (!fillableBtn) {
            return;
        }

        fillableBtn.addEventListener('click', async () => {
            try {
                fillableBtn.disabled = true;
                fillableBtn.textContent = 'Generating PDF...';
                await generateFillablePdf();
            } catch (error) {
                console.error('Error:', error);
                alert('An error occurred while generating the PDF. Please try again.');
            } finally {
                fillableBtn.disabled = false;
                fillableBtn.textContent = 'Save as Fillable PDF';
            }
        });

        async function generateFillablePdf() {
            const form = document.getElementById('dagForm');
            if (!form) {
                console.error('Form not found');
                throw new Error('Form not found');
            }

            if (!form.reportValidity()) {
                throw new Error('Form validation failed');
            }

            // Check for pdf-lib availability
            if (!window.PDFLib) {
                throw new Error('PDF library failed to load. Please refresh the page and try again.');
            }

            const { PDFDocument, rgb, StandardFonts } = window.PDFLib;
                const pdfDoc = await PDFDocument.create();
                const helvetica = await pdfDoc.embedFont(StandardFonts.Helvetica);
                const helveticaBold = await pdfDoc.embedFont(StandardFonts.HelveticaBold);
                
                let page = pdfDoc.addPage([595, 842]); // A4 in points
                const pageWidth = page.getWidth();
                const pageHeight = page.getHeight();
                const leftMargin = 40;
                const labelColumnWidth = 170;
                const fieldHeight = 18;
                let y = pageHeight - 50;
                const lineGap = 24;
                const fontSize = 10;
                const titleFontSize = 12;

                const formData = new FormData(form);
                const getFieldValue = (name) => {
                    if (name === 'declaration_confirmed') {
                        const checkbox = form.querySelector('[name="declaration_confirmed"]');
                        return checkbox && checkbox.checked ? 'Yes' : 'No';
                    }
                    const value = formData.get(name);
                    // Handle radio buttons
                    if (!value) {
                        const radio = form.querySelector(`[name="${name}"]:checked`);
                        return radio ? radio.value : '';
                    }
                    return value || '';
                };

                const ensureSpace = (lines = 1) => {
                    if (y - lineGap * lines < 40) {
                        page = pdfDoc.addPage([595, 842]);
                        y = pageHeight - 50;
                    }
                };

                const addSection = (title) => {
                    ensureSpace();
                    page.drawText(title, {
                        x: leftMargin,
                        y: y,
                        size: fontSize,
                        font: helveticaBold,
                    });
                    y -= 16;
                };

                const addTextField = (label, name, options = {}) => {
                    ensureSpace();
                    const width = options.width || 260;
                    const fieldX = leftMargin + labelColumnWidth;
                    const fieldY = y - fieldHeight;
                    
                    // Draw label
                    page.drawText(label, {
                        x: leftMargin,
                        y: y,
                        size: fontSize,
                        font: helvetica,
                    });
                    
                    // Create fillable text field using pdf-lib's form API
                    const form = pdfDoc.getForm();
                    const textField = form.createTextField(name);
                    textField.addToPage(page, {
                        x: fieldX,
                        y: fieldY,
                        width: width,
                        height: fieldHeight,
                        borderWidth: 1,
                        borderColor: rgb(0, 0, 0),
                        backgroundColor: rgb(1, 1, 1),
                    });
                    
                    // Set default value if present
                    const value = getFieldValue(name);
                    if (value) {
                        textField.setText(value);
                    }
                    
                    y -= options.lineGap || lineGap;
                };

                const yesNoHelper = (name, promptText) => {
                    addTextField(`${promptText} (Yes/No)`, name, { width: 80 });
                };

                const addWarningNotice = () => {
                    ensureSpace(5);
                    // Draw WARNING title
                    page.drawText('WARNING', {
                        x: leftMargin,
                        y: y,
                        size: fontSize,
                        font: helveticaBold,
                        color: rgb(0.72, 0.11, 0.11),
                    });
                    y -= 14;
                    
                    // Draw warning text (split into lines)
                    const maxWidth = pageWidth - leftMargin * 2;
                    const words = WARNING_TEXT.split(' ');
                    let currentLine = '';
                    const lines = [];
                    
                    words.forEach(word => {
                        const testLine = currentLine + (currentLine ? ' ' : '') + word;
                        const textWidth = helvetica.widthOfTextAtSize(testLine, fontSize);
                        if (textWidth > maxWidth && currentLine) {
                            lines.push(currentLine);
                            currentLine = word;
                        } else {
                            currentLine = testLine;
                        }
                    });
                    if (currentLine) lines.push(currentLine);
                    
                    lines.forEach((line) => {
                        ensureSpace();
                        page.drawText(line, {
                            x: leftMargin,
                            y: y,
                            size: fontSize,
                            font: helvetica,
                            color: rgb(0, 0, 0),
                        });
                        y -= 12;
                    });
                    y -= 10;
                };

            // Add header text
            page.drawText('Government of the Republic of Trinidad and Tobago', {
                x: leftMargin,
                y: y,
                size: titleFontSize,
                font: helveticaBold,
            });
            y -= 18;
            page.drawText('Ministry of the People, Social Development and Family Services', {
                x: leftMargin,
                y: y,
                size: titleFontSize,
                font: helveticaBold,
            });
            y -= 18;
            page.drawText('Disability Assistance Grant Application (Minors)', {
                x: leftMargin,
                y: y,
                size: titleFontSize,
                font: helveticaBold,
            });
            y -= 24;

            addSection('1. Applicant Details');
            addTextField('Last Name', 'app_lastname');
            addTextField('First Name', 'app_firstname');
            addTextField('Middle Name', 'app_middlename');
            addTextField('Date of Birth', 'app_dob', { width: 140 });
            addTextField('Age', 'app_age', { width: 60 });
            addTextField('Sex', 'app_sex', { width: 80 });
            addTextField('ID Card No.', 'app_id', { width: 140 });
            addTextField('Residential Address', 'app_res_address', { width: 300 });
            addTextField('Mailing Address', 'app_mail_address', { width: 300 });
            addTextField('Relationship to Beneficiary', 'app_relationship', { width: 180 });
            addTextField('Marital Status', 'app_marital', { width: 180 });
            addTextField('Status (Citizen / Legal Resident)', 'app_status', { width: 200 });
            addTextField('Resident No.', 'app_resident_no', { width: 180 });
            addTextField('Pin Number', 'app_pin', { width: 120 });
            addTextField('Contact No. (Cell)', 'app_cell', { width: 150 });
            addTextField('Contact No. (Home)', 'app_home', { width: 150 });

            addSection('2. Beneficiary Details');
            addTextField('Child Last Name', 'ben_lastname');
            addTextField('Child First Name', 'ben_firstname');
            addTextField('Child Middle Name', 'ben_middlename');
            addTextField('Child Date of Birth', 'ben_dob', { width: 140 });
            addTextField('Child Age', 'ben_age', { width: 60 });
            addTextField('Child Sex', 'ben_sex', { width: 80 });
            addTextField('Child ID Card No.', 'ben_id', { width: 140 });
            addTextField('Country of Birth', 'ben_cob', { width: 200 });
            addTextField('Status', 'ben_status', { width: 150 });
            addTextField('Resident No.', 'ben_res_no', { width: 150 });

            addSection("3. Parents' Information");
            addTextField("Mother's Name (if different)", 'mother_name', { width: 300 });
            addTextField("Father's Name (if different)", 'father_name', { width: 300 });

            addSection('4. Benefit Screening Questions');
            yesNoHelper('q1', 'Public Assistance received on behalf of child');
            yesNoHelper('q2', 'Other benefits on behalf of child');
            addTextField('If yes, how much?', 'q2_amount', { width: 120, lineGap: 20 });
            yesNoHelper('q3', 'Applied for this grant before');
            yesNoHelper('q4', 'Receive grant in another district');
            yesNoHelper('q5', 'Child holds Trinidad & Tobago Passport');
            addTextField('Passport Number', 'passport_number', { width: 140 });
            addTextField('Date of Departure (Last 3 Years)', 'date_departure', { width: 140 });
            addTextField('Date of Return (Last 3 Years)', 'date_return', { width: 140 });

            addWarningNotice();

            addSection('5. Declaration');
            addTextField('Declaration Confirmed (Yes/No)', 'declaration_confirmed', { width: 100 });
            addTextField('Declaration Date', 'decl_date', { width: 140 });

            // Save the PDF
            const pdfBytes = await pdfDoc.save();
            const blob = new Blob([pdfBytes], { type: 'application/pdf' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'disability-assistance-grant-fillable.pdf';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }
    })();
</script>
</body>
</html>
